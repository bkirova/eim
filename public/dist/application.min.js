"use strict";var ApplicationConfiguration=function(){var applicationModuleName="emotion-in-motion",applicationModuleVendorDependencies=["ngResource","ngCookies","ngAnimate","ngTouch","ngSanitize","ui.router","ui.bootstrap","ui.utils","vr.directives.slider","cfp.hotkeys"],registerModule=function(moduleName){angular.module(moduleName,[]),angular.module(applicationModuleName).requires.push(moduleName)};return{applicationModuleName:applicationModuleName,applicationModuleVendorDependencies:applicationModuleVendorDependencies,registerModule:registerModule}}();angular.module(ApplicationConfiguration.applicationModuleName,ApplicationConfiguration.applicationModuleVendorDependencies),angular.module(ApplicationConfiguration.applicationModuleName).config(["$locationProvider",function($locationProvider){$locationProvider.hashPrefix("!")}]),angular.element(document).ready(function(){"#_=_"===window.location.hash&&(window.location.hash="#!"),angular.bootstrap(document,[ApplicationConfiguration.applicationModuleName])}),ApplicationConfiguration.registerModule("angular-hotkeys"),ApplicationConfiguration.registerModule("core"),function(){angular.module("cfp.hotkeys",[]).provider("hotkeys",function(){this.includeCheatSheet=!0,this.templateTitle="Keyboard Shortcuts:",this.template='<div class="cfp-hotkeys-container fade" ng-class="{in: helpVisible}" style="display: none;"><div class="cfp-hotkeys"><h4 class="cfp-hotkeys-title">{{ title }}</h4><table><tbody><tr ng-repeat="hotkey in hotkeys | filter:{ description: \'!$$undefined$$\' }"><td class="cfp-hotkeys-keys"><span ng-repeat="key in hotkey.format() track by $index" class="cfp-hotkeys-key">{{ key }}</span></td><td class="cfp-hotkeys-text">{{ hotkey.description }}</td></tr></tbody></table><div class="cfp-hotkeys-close" ng-click="toggleCheatSheet()">×</div></div></div>',this.cheatSheetHotkey="?",this.cheatSheetDescription="Show / hide this help menu",this.$get=["$rootElement","$rootScope","$compile","$window","$document",function($rootElement,$rootScope,$compile,$window,$document){function symbolize(combo){var map={command:"⌘",shift:"⇧",left:"←",right:"→",up:"↑",down:"↓","return":"↩",backspace:"⌫"};combo=combo.split("+");for(var i=0;i<combo.length;i++)"mod"===combo[i]&&(combo[i]=$window.navigator&&$window.navigator.platform.indexOf("Mac")>=0?"command":"ctrl"),combo[i]=map[combo[i]]||combo[i];return combo.join(" + ")}function Hotkey(combo,description,callback,action,allowIn,persistent){this.combo=combo instanceof Array?combo:[combo],this.description=description,this.callback=callback,this.action=action,this.allowIn=allowIn,this.persistent=persistent}function purgeHotkeys(){for(var i=scope.hotkeys.length;i--;){var hotkey=scope.hotkeys[i];hotkey&&!hotkey.persistent&&_del(hotkey)}}function toggleCheatSheet(){scope.helpVisible=!scope.helpVisible,scope.helpVisible?(previousEsc=_get("esc"),_del("esc"),_add("esc",previousEsc.description,toggleCheatSheet)):(_del("esc"),previousEsc!==!1&&_add(previousEsc))}function _add(combo,description,callback,action,allowIn,persistent){var _callback,preventIn=["INPUT","SELECT","TEXTAREA"],objType=Object.prototype.toString.call(combo);if("[object Object]"===objType&&(description=combo.description,callback=combo.callback,action=combo.action,persistent=combo.persistent,allowIn=combo.allowIn,combo=combo.combo),description instanceof Function?(action=callback,callback=description,description="$$undefined$$"):angular.isUndefined(description)&&(description="$$undefined$$"),void 0===persistent&&(persistent=!0),"function"==typeof callback){_callback=callback,allowIn instanceof Array||(allowIn=[]);for(var index,i=0;i<allowIn.length;i++)allowIn[i]=allowIn[i].toUpperCase(),index=preventIn.indexOf(allowIn[i]),-1!==index&&preventIn.splice(index,1);callback=function(event){var shouldExecute=!0,target=event.target||event.srcElement,nodeName=target.nodeName.toUpperCase();if((" "+target.className+" ").indexOf(" mousetrap ")>-1)shouldExecute=!0;else for(var i=0;i<preventIn.length;i++)if(preventIn[i]===nodeName){shouldExecute=!1;break}shouldExecute&&wrapApply(_callback.apply(this,arguments))}}"string"==typeof action?Mousetrap.bind(combo,wrapApply(callback),action):Mousetrap.bind(combo,wrapApply(callback));var hotkey=new Hotkey(combo,description,callback,action,allowIn,persistent);return scope.hotkeys.push(hotkey),hotkey}function _del(hotkey){var combo=hotkey instanceof Hotkey?hotkey.combo:hotkey;if(Mousetrap.unbind(combo),combo instanceof Array){for(var retStatus=!0,i=0;i<combo.length;i++)retStatus=_del(combo[i])&&retStatus;return retStatus}var index=scope.hotkeys.indexOf(_get(combo));return index>-1?(scope.hotkeys[index].combo.length>1?scope.hotkeys[index].combo.splice(scope.hotkeys[index].combo.indexOf(combo),1):scope.hotkeys.splice(index,1),!0):!1}function _get(combo){for(var hotkey,i=0;i<scope.hotkeys.length;i++)if(hotkey=scope.hotkeys[i],hotkey.combo.indexOf(combo)>-1)return hotkey;return!1}function bindTo(scope){return boundScopes[scope.$id]=[],scope.$on("$destroy",function(){for(var i=boundScopes[scope.$id].length;i--;)_del(boundScopes[scope.$id][i]),delete boundScopes[scope.$id][i]}),{add:function(args){var hotkey;return hotkey=arguments.length>1?_add.apply(this,arguments):_add(args),boundScopes[scope.$id].push(hotkey),this}}}function wrapApply(callback){return function(event,combo){if(callback instanceof Array){var funcString=callback[0],route=callback[1];callback=function(){route.scope.$eval(funcString)}}$rootScope.$apply(function(){callback(event,_get(combo))})}}Mousetrap.stopCallback=function(event,element){return(" "+element.className+" ").indexOf(" mousetrap ")>-1?!1:element.contentEditable&&"true"==element.contentEditable},Hotkey.prototype.format=function(){for(var combo=this.combo[0],sequence=combo.split(/[\s]/),i=0;i<sequence.length;i++)sequence[i]=symbolize(sequence[i]);return sequence};var scope=$rootScope.$new();scope.hotkeys=[],scope.helpVisible=!1,scope.title=this.templateTitle,scope.toggleCheatSheet=toggleCheatSheet;var boundScopes=[];if($rootScope.$on("$routeChangeSuccess",function(event,route){purgeHotkeys(),route&&route.hotkeys&&angular.forEach(route.hotkeys,function(hotkey){var callback=hotkey[2];("string"==typeof callback||callback instanceof String)&&(hotkey[2]=[callback,route]),hotkey[5]=!1,_add.apply(this,hotkey)})}),this.includeCheatSheet){var document=$document[0],element=$rootElement[0],helpMenu=angular.element(this.template);_add(this.cheatSheetHotkey,this.cheatSheetDescription,toggleCheatSheet),(element===document||element===document.documentElement)&&(element=document.body),angular.element(element).append($compile(helpMenu)(scope))}var previousEsc=!1,publicApi={add:_add,del:_del,get:_get,bindTo:bindTo,template:this.template,toggleCheatSheet:toggleCheatSheet,includeCheatSheet:this.includeCheatSheet,cheatSheetHotkey:this.cheatSheetHotkey,cheatSheetDescription:this.cheatSheetDescription,purgeHotkeys:purgeHotkeys,templateTitle:this.templateTitle};return publicApi}]}).directive("hotkey",["hotkeys",function(hotkeys){return{restrict:"A",link:function(scope,el,attrs){var key,allowIn;angular.forEach(scope.$eval(attrs.hotkey),function(func,hotkey){allowIn="string"==typeof attrs.hotkeyAllowIn?attrs.hotkeyAllowIn.split(/[\s,]+/):[],key=hotkey,hotkeys.add({combo:hotkey,description:attrs.hotkeyDescription,callback:func,action:attrs.hotkeyAction,allowIn:allowIn})}),el.bind("$destroy",function(){hotkeys.del(key)})}}}]).run(["hotkeys",function(){}])}(),function(window,document){function _addEvent(object,type,callback){return object.addEventListener?void object.addEventListener(type,callback,!1):void object.attachEvent("on"+type,callback)}function _characterFromEvent(e){if("keypress"==e.type){var character=String.fromCharCode(e.which);return e.shiftKey||(character=character.toLowerCase()),character}return _MAP[e.which]?_MAP[e.which]:_KEYCODE_MAP[e.which]?_KEYCODE_MAP[e.which]:String.fromCharCode(e.which).toLowerCase()}function _modifiersMatch(modifiers1,modifiers2){return modifiers1.sort().join(",")===modifiers2.sort().join(",")}function _resetSequences(doNotReset){doNotReset=doNotReset||{};var key,activeSequences=!1;for(key in _sequenceLevels)doNotReset[key]?activeSequences=!0:_sequenceLevels[key]=0;activeSequences||(_nextExpectedAction=!1)}function _getMatches(character,modifiers,e,sequenceName,combination,level){var i,callback,matches=[],action=e.type;if(!_callbacks[character])return[];for("keyup"==action&&_isModifier(character)&&(modifiers=[character]),i=0;i<_callbacks[character].length;++i)if(callback=_callbacks[character][i],(sequenceName||!callback.seq||_sequenceLevels[callback.seq]==callback.level)&&action==callback.action&&("keypress"==action&&!e.metaKey&&!e.ctrlKey||_modifiersMatch(modifiers,callback.modifiers))){var deleteCombo=!sequenceName&&callback.combo==combination,deleteSequence=sequenceName&&callback.seq==sequenceName&&callback.level==level;(deleteCombo||deleteSequence)&&_callbacks[character].splice(i,1),matches.push(callback)}return matches}function _eventModifiers(e){var modifiers=[];return e.shiftKey&&modifiers.push("shift"),e.altKey&&modifiers.push("alt"),e.ctrlKey&&modifiers.push("ctrl"),e.metaKey&&modifiers.push("meta"),modifiers}function _preventDefault(e){return e.preventDefault?void e.preventDefault():void(e.returnValue=!1)}function _stopPropagation(e){return e.stopPropagation?void e.stopPropagation():void(e.cancelBubble=!0)}function _fireCallback(callback,e,combo,sequence){Mousetrap.stopCallback(e,e.target||e.srcElement,combo,sequence)||callback(e,combo)===!1&&(_preventDefault(e),_stopPropagation(e))}function _handleKey(character,modifiers,e){var i,callbacks=_getMatches(character,modifiers,e),doNotReset={},maxLevel=0,processedSequenceCallback=!1;for(i=0;i<callbacks.length;++i)callbacks[i].seq&&(maxLevel=Math.max(maxLevel,callbacks[i].level));for(i=0;i<callbacks.length;++i)if(callbacks[i].seq){if(callbacks[i].level!=maxLevel)continue;processedSequenceCallback=!0,doNotReset[callbacks[i].seq]=1,_fireCallback(callbacks[i].callback,e,callbacks[i].combo,callbacks[i].seq)}else processedSequenceCallback||_fireCallback(callbacks[i].callback,e,callbacks[i].combo);var ignoreThisKeypress="keypress"==e.type&&_ignoreNextKeypress;e.type!=_nextExpectedAction||_isModifier(character)||ignoreThisKeypress||_resetSequences(doNotReset),_ignoreNextKeypress=processedSequenceCallback&&"keydown"==e.type}function _handleKeyEvent(e){"number"!=typeof e.which&&(e.which=e.keyCode);var character=_characterFromEvent(e);if(character)return"keyup"==e.type&&_ignoreNextKeyup===character?void(_ignoreNextKeyup=!1):void Mousetrap.handleKey(character,_eventModifiers(e),e)}function _isModifier(key){return"shift"==key||"ctrl"==key||"alt"==key||"meta"==key}function _resetSequenceTimer(){clearTimeout(_resetTimer),_resetTimer=setTimeout(_resetSequences,1e3)}function _getReverseMap(){if(!_REVERSE_MAP){_REVERSE_MAP={};for(var key in _MAP)key>95&&112>key||_MAP.hasOwnProperty(key)&&(_REVERSE_MAP[_MAP[key]]=key)}return _REVERSE_MAP}function _pickBestAction(key,modifiers,action){return action||(action=_getReverseMap()[key]?"keydown":"keypress"),"keypress"==action&&modifiers.length&&(action="keydown"),action}function _bindSequence(combo,keys,callback,action){function _increaseSequence(nextAction){return function(){_nextExpectedAction=nextAction,++_sequenceLevels[combo],_resetSequenceTimer()}}function _callbackAndReset(e){_fireCallback(callback,e,combo),"keyup"!==action&&(_ignoreNextKeyup=_characterFromEvent(e)),setTimeout(_resetSequences,10)}_sequenceLevels[combo]=0;for(var i=0;i<keys.length;++i){var isFinal=i+1===keys.length,wrappedCallback=isFinal?_callbackAndReset:_increaseSequence(action||_getKeyInfo(keys[i+1]).action);_bindSingle(keys[i],wrappedCallback,action,combo,i)}}function _keysFromString(combination){return"+"===combination?["+"]:combination.split("+")}function _getKeyInfo(combination,action){var keys,key,i,modifiers=[];for(keys=_keysFromString(combination),i=0;i<keys.length;++i)key=keys[i],_SPECIAL_ALIASES[key]&&(key=_SPECIAL_ALIASES[key]),action&&"keypress"!=action&&_SHIFT_MAP[key]&&(key=_SHIFT_MAP[key],modifiers.push("shift")),_isModifier(key)&&modifiers.push(key);return action=_pickBestAction(key,modifiers,action),{key:key,modifiers:modifiers,action:action}}function _bindSingle(combination,callback,action,sequenceName,level){_directMap[combination+":"+action]=callback,combination=combination.replace(/\s+/g," ");var info,sequence=combination.split(" ");return sequence.length>1?void _bindSequence(combination,sequence,callback,action):(info=_getKeyInfo(combination,action),_callbacks[info.key]=_callbacks[info.key]||[],_getMatches(info.key,info.modifiers,{type:info.action},sequenceName,combination,level),void _callbacks[info.key][sequenceName?"unshift":"push"]({callback:callback,modifiers:info.modifiers,action:info.action,seq:sequenceName,level:level,combo:combination}))}function _bindMultiple(combinations,callback,action){for(var i=0;i<combinations.length;++i)_bindSingle(combinations[i],callback,action)}for(var _REVERSE_MAP,_resetTimer,_MAP={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},_KEYCODE_MAP={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},_SHIFT_MAP={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},_SPECIAL_ALIASES={option:"alt",command:"meta","return":"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},_callbacks={},_directMap={},_sequenceLevels={},_ignoreNextKeyup=!1,_ignoreNextKeypress=!1,_nextExpectedAction=!1,i=1;20>i;++i)_MAP[111+i]="f"+i;for(i=0;9>=i;++i)_MAP[i+96]=i;_addEvent(document,"keypress",_handleKeyEvent),_addEvent(document,"keydown",_handleKeyEvent),_addEvent(document,"keyup",_handleKeyEvent);var Mousetrap={bind:function(keys,callback,action){return keys=keys instanceof Array?keys:[keys],_bindMultiple(keys,callback,action),this},unbind:function(keys,action){return Mousetrap.bind(keys,function(){},action)},trigger:function(keys,action){return _directMap[keys+":"+action]&&_directMap[keys+":"+action]({},keys),this},reset:function(){return _callbacks={},_directMap={},this},stopCallback:function(e,element){return(" "+element.className+" ").indexOf(" mousetrap ")>-1?!1:"INPUT"==element.tagName||"SELECT"==element.tagName||"TEXTAREA"==element.tagName||element.isContentEditable},handleKey:_handleKey};window.Mousetrap=Mousetrap,"function"==typeof define&&define.amd&&define(Mousetrap)}(window,document),angular.module("core").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/"),$stateProvider.state("home",{url:"/",templateUrl:"modules/core/views/home.client.view.html"}).state("start",{url:"/start",templateUrl:"modules/core/views/start.client.view.html"}).state("sound-test",{url:"/sound-test",templateUrl:"modules/core/views/sound-test.client.view.html"}).state("eda-instructions",{url:"/eda-instructions",templateUrl:"modules/core/views/eda-instructions.client.view.html"}).state("pox-instructions",{url:"/pox-instructions",templateUrl:"modules/core/views/pox-instructions.client.view.html"}).state("signal-test",{url:"/signal-test",templateUrl:"modules/core/views/signal-test.client.view.html"}).state("demographics",{url:"/demographics",templateUrl:"modules/core/views/demographics.client.view.html"}).state("musical-background",{url:"/musical-background",templateUrl:"modules/core/views/musical-background.client.view.html"})}]),angular.module("core").controller("DemographicsController",["$scope","TrialData",function($scope,TrialData){$scope.trialData=TrialData,$scope.nationalities=["Afghan","Albanian","Algerian","American","Andorran","Angolan","Antiguans","Argentinean","Armenian","Australian","Austrian","Azerbaijani","Bahamian","Bahraini","Bangladeshi","Barbadian","Barbudans","Batswana","Belarusian","Belgian","Belizean","Beninese","Bhutanese","Bolivian","Bosnian","Brazilian","British","Bruneian","Bulgarian","Burkinabe","Burmese","Burundian","Cambodian","Cameroonian","Canadian","Cape Verdean","Central African","Chadian","Chilean","Chinese","Colombian","Comoran","Congolese","Costa Rican","Croatian","Cuban","Cypriot","Czech","Danish","Djibouti","Dominican","Dutch","East Timorese","Ecuadorean","Egyptian","Emirian","Equatorial Guinean","Eritrean","Estonian","Ethiopian","Fijian","Filipino","Finnish","French","Gabonese","Gambian","Georgian","German","Ghanaian","Greek","Grenadian","Guatemalan","Guinea-Bissauan","Guinean","Guyanese","Haitian","Herzegovinian","Honduran","Hungarian","I-Kiribati","Icelander","Indian","Indonesian","Iranian","Iraqi","Irish","Israeli","Italian","Ivorian","Jamaican","Japanese","Jordanian","Kazakhstani","Kenyan","Kittian and Nevisian","Kuwaiti","Kyrgyz","Laotian","Latvian","Lebanese","Liberian","Libyan","Liechtensteiner","Lithuanian","Luxembourger","Macedonian","Malagasy","Malawian","Malaysian","Maldivan","Malian","Maltese","Marshallese","Mauritanian","Mauritian","Mexican","Micronesian","Moldovan","Monacan","Mongolian","Moroccan","Mosotho","Motswana","Mozambican","Namibian","Nauruan","Nepalese","New Zealander","Nicaraguan","Nigerian","Nigerien","North Korean","Northern Irish","Norwegian","Omani","Pakistani","Palauan","Panamanian","Papua New Guinean","Paraguayan","Peruvian","Polish","Portuguese","Qatari","Romanian","Russian","Rwandan","SaintLucian","Salvadoran","Samoan","San Marinese","Sao Tomean","Saudi","Scottish","Senegalese","Serbian","Seychellois","Sierra Leonean","Singaporean","Slovakian","Slovenian","Solomon Islander","Somali","South African","South Korean","Spanish","Sri Lankan","Sudanese","Surinamer","Swazi","Swedish","Swiss","Syrian","Taiwanese","Tajik","Tanzanian","Thai","Togolese","Tongan","Trinidadian or Tobagonian","Tunisian","Turkish","Tuvaluan","Ugandan","Ukrainian","Uruguayan","Uzbekistani","Venezuelan","Vietnamese","Welsh","Yemenite","Zambian","Zimbabwean"],$scope.years=[];for(var thisYear=(new Date).getFullYear(),i=thisYear-110;thisYear>=i;i++)$scope.years.push(i);$scope.nationalityChanged=function(nationality){TrialData.data.answers.nationality=nationality.toLowerCase()},$scope.yearChanged=function(year){TrialData.data.answers.birthyear=year},$scope.genderChanged=function(gender){TrialData.data.answers.gender=gender},$scope.trialDataJson=function(){return TrialData.toJson()}}]),angular.module("core").controller("HeaderController",["$scope",function(){}]),angular.module("core").controller("HomeController",["$scope","$http",function(){}]),angular.module("core").controller("MasterController",["$scope","TrialData","hotkeys",function($scope,TrialData,hotkeys){$scope.trialDataJson=function(){return TrialData.toJson()},$scope.debugMode=!1,hotkeys.add({combo:"d d",description:"Toggle debug mode",callback:function(){$scope.debugMode=!$scope.debugMode;var alertMessage="Debug mode has been ";alertMessage+=$scope.debugMode?"enabled.":"disabled.",$scope.addAlert({type:"info",msg:alertMessage})}}),$scope.alerts=[],$scope.addAlert=function(alert){for(var errorExists=!1,i=0;i<$scope.alerts.length;i++)if($scope.alerts[i].msg===alert.msg&&$scope.alerts[i].type===alert.type){errorExists=!0;break}errorExists||$scope.alerts.push(alert)},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.addGenericErrorAlert=function(){$scope.addAlert({type:"danger",msg:"There seems to be a problem. Please contact a mediator for assistance."})}}]),angular.module("core").controller("DemographicsController",["$scope","TrialData",function($scope,TrialData){$scope.trialData=TrialData,$scope.nationalities=["Afghan","Albanian","Algerian","American","Andorran","Angolan","Antiguans","Argentinean","Armenian","Australian","Austrian","Azerbaijani","Bahamian","Bahraini","Bangladeshi","Barbadian","Barbudans","Batswana","Belarusian","Belgian","Belizean","Beninese","Bhutanese","Bolivian","Bosnian","Brazilian","British","Bruneian","Bulgarian","Burkinabe","Burmese","Burundian","Cambodian","Cameroonian","Canadian","Cape Verdean","Central African","Chadian","Chilean","Chinese","Colombian","Comoran","Congolese","Costa Rican","Croatian","Cuban","Cypriot","Czech","Danish","Djibouti","Dominican","Dutch","East Timorese","Ecuadorean","Egyptian","Emirian","Equatorial Guinean","Eritrean","Estonian","Ethiopian","Fijian","Filipino","Finnish","French","Gabonese","Gambian","Georgian","German","Ghanaian","Greek","Grenadian","Guatemalan","Guinea-Bissauan","Guinean","Guyanese","Haitian","Herzegovinian","Honduran","Hungarian","I-Kiribati","Icelander","Indian","Indonesian","Iranian","Iraqi","Irish","Israeli","Italian","Ivorian","Jamaican","Japanese","Jordanian","Kazakhstani","Kenyan","Kittian and Nevisian","Kuwaiti","Kyrgyz","Laotian","Latvian","Lebanese","Liberian","Libyan","Liechtensteiner","Lithuanian","Luxembourger","Macedonian","Malagasy","Malawian","Malaysian","Maldivan","Malian","Maltese","Marshallese","Mauritanian","Mauritian","Mexican","Micronesian","Moldovan","Monacan","Mongolian","Moroccan","Mosotho","Motswana","Mozambican","Namibian","Nauruan","Nepalese","New Zealander","Nicaraguan","Nigerian","Nigerien","North Korean","Northern Irish","Norwegian","Omani","Pakistani","Palauan","Panamanian","Papua New Guinean","Paraguayan","Peruvian","Polish","Portuguese","Qatari","Romanian","Russian","Rwandan","SaintLucian","Salvadoran","Samoan","San Marinese","Sao Tomean","Saudi","Scottish","Senegalese","Serbian","Seychellois","Sierra Leonean","Singaporean","Slovakian","Slovenian","Solomon Islander","Somali","South African","South Korean","Spanish","Sri Lankan","Sudanese","Surinamer","Swazi","Swedish","Swiss","Syrian","Taiwanese","Tajik","Tanzanian","Thai","Togolese","Tongan","Trinidadian or Tobagonian","Tunisian","Turkish","Tuvaluan","Ugandan","Ukrainian","Uruguayan","Uzbekistani","Venezuelan","Vietnamese","Welsh","Yemenite","Zambian","Zimbabwean"],$scope.years=[];for(var thisYear=(new Date).getFullYear(),i=thisYear-110;thisYear>=i;i++)$scope.years.push(i);$scope.nationalityChanged=function(nationality){TrialData.data.answers.nationality=nationality.toLowerCase()},$scope.yearChanged=function(year){TrialData.data.answers.birthyear=year},$scope.genderChanged=function(gender){TrialData.data.answers.gender=gender},$scope.trialDataJson=function(){return TrialData.toJson()}}]),angular.module("core").controller("SignalTestController",["$scope","TrialData",function($scope,TrialData){$scope.edaQuality=0,$scope.poxQuality=0;var socket=io();socket.on("oscMessageSent",function(data){console.log('socket "oscMessageSent" event received with data: '+data)});var sendStartSignalTestMessage=function(){socket.emit("sendOSCMessage",{oscType:"message",address:"/eim/control/startSignalTest",args:{type:"string",value:""+TrialData.data.metadata.session_number}})};socket.on("oscMessageReceived",function(data){console.log("got OSC message"),"/eim/status/signalQuality/eda"===data.address?$scope.$apply(function(){$scope.edaQuality=data.args[0].value}):"/eim/status/signalQuality/pox"===data.address&&$scope.$apply(function(){$scope.poxQuality=data.args[0].value})}),sendStartSignalTestMessage()}]),angular.module("core").controller("SoundTestController",["$scope","TrialData",function($scope,TrialData){var socket=io();socket.on("oscMessageSent",function(data){console.log('socket "oscMessageSent" event received with data: '+data)}),socket.emit("sendOSCMessage",{oscType:"message",address:"/eim/control/startSoundTest",args:{type:"string",value:TrialData.data.metadata.session_number}}),$scope.stopSoundTest=function(){socket.emit("sendOSCMessage",{oscType:"message",address:"/eim/control/stopSoundTest",args:{type:"string",value:TrialData.data.metadata.session_number}})},$scope.trialDataJson=function(){return TrialData.toJson()}}]),angular.module("core").controller("StartController",["$scope","$http","$timeout","TrialData",function($scope,$http,$timeout,TrialData){$scope.maxReady=!1,$scope.backendReady=!1,$scope.experimentReady=function(){return $scope.debugMode?!0:$scope.maxReady&&$scope.backendReady},TrialData.reset();var socket=io(),sessionID=UUID.generate();TrialData.data.metadata.session_number=sessionID,socket.on("oscMessageSent",function(data){console.log('socket "oscMessageSent" event received with data: '+data)}),socket.on("oscMessageReceived",function(data){"/eim/status/resetComplete"===data.address?socket.emit("sendOSCMessage",{oscType:"message",address:"/eim/control/startExperiment",args:{type:"string",value:TrialData.data.metadata.session_number}}):"/eim/status/experimentReady"===data.address&&$scope.$apply(function(){$scope.maxReady=!0})}),$http.get("/api/experiment-schemas/random").success(function(data){for(var i in data.media)TrialData.data.media.push(data.media[i].label);if(!(data.media.length>0))throw $scope.addGenericErrorAlert(),new Error("No media was found in the fetched experiment schema");$scope.backendReady=!0}).error(function(){throw $scope.addGenericErrorAlert(),new Error("An experiment schema could not be fetched from the server")}),$timeout(function(){if(!$scope.experimentReady())throw $scope.addGenericErrorAlert(),new Error("The experiment was not setup after 10 seconds")},1e4)}]),angular.module("core").directive("displayTrialData",function(){return{restrict:"AE",template:"<div><h3>Trial Data</h3><pre>{{trialDataJson()}}</pre></div>"}}),angular.module("core").directive("sliderScale",function(){return{restrict:"E",template:function(element,attrs){var htmlString="";switch(attrs.imageType){case"single":return htmlString='<div class="row"><div class="col-md-12 slider-image text-center"><img src="'+attrs.singleImageSrc+'" /></div><div class="col-md-2 text-center slider-image"></div><!----><div class="col-md-8 slider-image"><slider ng-model="'+attrs.sliderNgModel+'" floor="'+attrs.sliderFloor+'" ceiling="'+attrs.sliderCeiling+'" step="'+attrs.sliderStep+'" stretch="'+attrs.sliderStretch+'" ng-init="'+attrs.sliderNgModel+"="+attrs.sliderInitialValue+'"></slider></div><!----><div class="col-md-2 text-center slider-image"></div></div>';case"extremes":return htmlString='<div class="row"><div class="col-md-2 text-center slider-image"></div><div class="col-md-2 slider-image text-center"><img src="'+attrs.leftImageSrc+'" /></div><!----><div class="col-md-4 slider-image"></div><!----><div class="col-md-2 slider-image text-center"><img src="'+attrs.rightImageSrc+'" /></div><!----><div class="col-md-2 text-center slider-image"></div><div class="col-md-2 text-center slider-image"></div><!----><div class="col-md-8 slider-image"><slider ng-model="'+attrs.sliderNgModel+'" floor="'+attrs.sliderFloor+'" ceiling="'+attrs.sliderCeiling+'" step="'+attrs.sliderStep+'" stretch="'+attrs.sliderStretch+'" ng-init="'+attrs.sliderNgModel+"="+attrs.sliderInitialValue+'"></slider></div><!----><div class="col-md-2 text-center slider-image"></div></div>';default:return htmlString='<div class="row"><div class="col-md-2 text-center slider-image"></div><!----><div class="col-md-8 slider-image"><slider ng-model="'+attrs.sliderNgModel+'" floor="'+attrs.sliderFloor+'" ceiling="'+attrs.sliderCeiling+'" step="'+attrs.sliderStep+'" stretch="'+attrs.sliderStretch+'" ng-init="'+attrs.sliderNgModel+"="+attrs.sliderInitialValue+'"></slider></div><!----><div class="col-md-2 text-center slider-image"></div></div>'}}}}),angular.module("core").service("Menus",[function(){this.defaultRoles=["user"],this.menus={};var shouldRender=function(user){if(!user)return this.isPublic;for(var userRoleIndex in user.roles)for(var roleIndex in this.roles)if(this.roles[roleIndex]===user.roles[userRoleIndex])return!0;return!1};this.validateMenuExistance=function(menuId){if(menuId&&menuId.length){if(this.menus[menuId])return!0;throw new Error("Menu does not exists")}throw new Error("MenuId was not provided")},this.getMenu=function(menuId){return this.validateMenuExistance(menuId),this.menus[menuId]},this.addMenu=function(menuId,isPublic,roles){return this.menus[menuId]={isPublic:isPublic||!1,roles:roles||this.defaultRoles,items:[],shouldRender:shouldRender},this.menus[menuId]},this.removeMenu=function(menuId){this.validateMenuExistance(menuId),delete this.menus[menuId]},this.addMenuItem=function(menuId,menuItemTitle,menuItemURL,menuItemType,menuItemUIRoute,isPublic,roles){return this.validateMenuExistance(menuId),this.menus[menuId].items.push({title:menuItemTitle,link:menuItemURL,menuItemType:menuItemType||"item",menuItemClass:menuItemType,uiRoute:menuItemUIRoute||"/"+menuItemURL,isPublic:isPublic||this.menus[menuId].isPublic,roles:roles||this.defaultRoles,items:[],shouldRender:shouldRender}),this.menus[menuId]},this.addSubMenuItem=function(menuId,rootMenuItemURL,menuItemTitle,menuItemURL,menuItemUIRoute,isPublic,roles){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)this.menus[menuId].items[itemIndex].link===rootMenuItemURL&&this.menus[menuId].items[itemIndex].items.push({title:menuItemTitle,link:menuItemURL,uiRoute:menuItemUIRoute||"/"+menuItemURL,isPublic:isPublic||this.menus[menuId].isPublic,roles:roles||this.defaultRoles,shouldRender:shouldRender});return this.menus[menuId]},this.removeMenuItem=function(menuId,menuItemURL){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)this.menus[menuId].items[itemIndex].link===menuItemURL&&this.menus[menuId].items.splice(itemIndex,1);return this.menus[menuId]},this.removeSubMenuItem=function(menuId,submenuItemURL){this.validateMenuExistance(menuId);for(var itemIndex in this.menus[menuId].items)for(var subitemIndex in this.menus[menuId].items[itemIndex].items)this.menus[menuId].items[itemIndex].items[subitemIndex].link===submenuItemURL&&this.menus[menuId].items[itemIndex].items.splice(subitemIndex,1);return this.menus[menuId]},this.addMenu("topbar")}]),angular.module("core").factory("TrialData",[function(){function blankDataObject(){return{answers:{musical_expertise:null,musical_background:null,most_engaged:null,hearing_impairements:null,visual_impairements:null,nationality:null,dob:null,sex:null,music_styles:[],most_enjoyed:null,emotion_indices:[],ratings:{positivity:[],like_dislike:[],familiarity:[],engagement:[],activity:[],chills:[],power:[]}},date:null,media:[],timestamps:{start:null,test:null,media:[],end:null},metadata:{session_number:null,location:"taipei_city",terminal:null}}}var trialData={data:{answers:{musical_expertise:null,musical_background:null,most_engaged:null,hearing_impairements:null,visual_impairements:null,nationality:null,dob:null,sex:null,music_styles:[],most_enjoyed:null,emotion_indices:[],ratings:{positivity:[],like_dislike:[],familiarity:[],engagement:[],activity:[],chills:[],power:[]}},date:null,media:[],timestamps:{start:null,test:null,media:[],end:null},metadata:{session_number:null,location:"taipei_city",terminal:null}},toJson:function(){return angular.toJson(this.data,!0)},reset:function(){this.data=blankDataObject()}};return trialData}]);